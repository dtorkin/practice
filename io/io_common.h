/*
 * io/io_common.h
 *
 * Описание:
 * Прототипы общих функций для отправки и приема сообщений протокола
 * через нижележащий слой ввода-вывода (пока только сокеты).
 */

#ifndef IO_COMMON_H
#define IO_COMMON_H

#include "../protocol/protocol_defs.h" // Используем относительный путь или настроим include path
#include <stddef.h> // для size_t
#include <sys/types.h> // для ssize_t

/*
 * Отправляет полное сообщение (заголовок + тело) через указанный дескриптор.
 * Выполняет преобразование в сетевой порядок байт перед отправкой.
 *
 * @param handle Дескриптор (сокет).
 * @param message Указатель на сообщение для отправки.
 * @return 0 в случае успеха, -1 в случае ошибки.
 */
int send_message(int handle, Message *message);

/*
 * Получает полное сообщение (заголовок + тело) из указанного дескриптора.
 * Выполняет преобразование в хостовый порядок байт после получения.
 * Блокируется до получения полного сообщения или возникновения ошибки/закрытия.
 *
 * @param handle Дескриптор (сокет).
 * @param message Указатель на структуру Message, куда будет записано полученное сообщение.
 * @return 0 в случае успеха,
 *         -1 в случае ошибки чтения/формата,
 *         1 если соединение было закрыто удаленной стороной.
 */
int receive_full_message(int handle, Message *message);

#endif // IO_COMMON_H