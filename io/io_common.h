/*
 * io/io_common.h
 *
 * Описание:
 * Прототипы общих функций для отправки и приема *протокольных сообщений*
 * через абстрактный слой ввода-вывода (IOInterface).
 */

#ifndef IO_COMMON_H
#define IO_COMMON_H

#include "../protocol/protocol_defs.h" // Определения Message и т.д.
#include "io_interface.h"             // Определение IOInterface
#include <stddef.h>
#include <sys/types.h>

/**
 * @brief Отправляет полное *протокольное сообщение* (заголовок + тело)
 *        через указанный интерфейс и дескриптор.
 * Выполняет преобразование в сетевой порядок байт перед отправкой
 * и обратно в хостовый после отправки.
 *
 * @param io Указатель на инициализированный IOInterface.
 * @param handle Дескриптор соединения/порта для отправки.
 * @param message Указатель на сообщение для отправки.
 * @return 0 в случае успеха, -1 в случае ошибки.
 */
int send_protocol_message(IOInterface *io, int handle, Message *message); // Переименовали для ясности

/**
 * @brief Получает полное *протокольное сообщение* (заголовок + тело)
 *        из указанного интерфейса и дескриптора.
 * Выполняет преобразование в хостовый порядок байт после получения.
 * Блокируется до получения полного сообщения или возникновения ошибки/закрытия.
 *
 * @param io Указатель на инициализированный IOInterface.
 * @param handle Дескриптор соединения/порта для чтения.
 * @param message Указатель на структуру Message, куда будет записано полученное сообщение.
 * @return 0 в случае успеха,
 *         -1 в случае ошибки чтения/формата,
 *         1 если соединение было закрыто удаленной стороной.
 */
int receive_protocol_message(IOInterface *io, int handle, Message *message); // Переименовали для ясности

#endif // IO_COMMON_H